<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>ws Wdiff src/java.security.jgss/share/classes/sun/security/jgss/krb5/Krb5InitCredential.java</title>

    <meta http-equiv="cache-control" content="no-cache" />

    <style type='text/css' media='screen'>
      pre	{ margin: 2px; }

      body	{ background-color: #eeeeee; }

      hr	{ border: none 0; border-top: 1px solid #aaa; height: 1px; }

      .subtracted { color: brown }
      .added	{ color: blue }

      .elided	{ border: 1px solid #444; cursor: pointer; margin: 1px }

      table.hidebar { border: 1px solid #ff9900; background-color: #eee;
      		  text-align: center; border-collapse: collapse; }

      .hidebar td.active-down { border: 1px solid #ff9900;
		border-right: 1px solid #ccc; cursor: s-resize }

      .hidebar td.active-down:hover { background-color: #ffcc99; }

      .hidebar td.active-up { border: 1px solid #ff9900; cursor: n-resize;
		border-left: 1px solid #ccc; }

      .hidebar td.active-up:hover { background-color: #ffcc99; }

      .hidebar td.elided-label { font-style: italic; width: 12em; }

      .cmdbox	{ position: fixed; top: 0; right: 0;
	          border-left: solid 1px #444;
	          border-bottom: solid 1px #444;
      		  background-color: #ccc; text-align: center }

      .cmdbox td { background-color: #eee; border: 1px #444 outset;
		   cursor: pointer; padding: 3px 4px; }
      .cmdbox td:hover { background-color: #ffcc99;
 		outline: thin solid #ff9900; }

      a:hover { background-color: #ffcc99; }

      a.print { font-size: x-small; }
    </style>

    <style type='text/css' media='print'>
	pre { font-family: courier, monospace; font-size: 0.8em; }
	.cmdbox { display: none; }
        a.print { display: none; }
	.hidebar td.active-down { display: none; }
	.hidebar td.active-up { display: none; }
        .hidebar td.elided-label { font-style: italic; font-size: small; }
	table.hidebar { border: none; border-bottom: 1px dotted #000000; }
	span.added { font-weight: bold;
	         background-color: #eee; width: 100%; display: block; }
	span.subtracted { font-style: italic;
		 background-color: #eee; width: 100%; display: block; }
	.elided { display: none; }
        hr { border: none 0; border-top: 1px solid #aaa; height: 1px; }
    </style>

    <script type="text/javascript">
      function show_n_hide_dir(id_to_show, id_to_hide, dir) {
	      var elt_to_show = document.getElementById(id_to_show);
	      var elt_to_hide = document.getElementById(id_to_hide);
	      // When we're opening up, we need to make the bottoms of the
	      // elements appear to be the same.  So our invariant should be
	      // elt.offsetBottom - window.scrollY.
	      var preinvar = elt_to_hide.offsetHeight - window.scrollY;
	      elt_to_show.style.setProperty('display', '', '');
	      elt_to_hide.style.setProperty('display', 'none', '');
	      if (dir == 'up') {
		      var postinvar = elt_to_show.offsetHeight - window.scrollY;
		      window.scrollBy(0, postinvar - preinvar);
	      }
      }

      function handle_click(e) {
	      var eh = e.target;
	      var es = document.getElementById("hb-" + e.target.id);
	      eh.style.setProperty('display', 'none', '');
	      es.style.setProperty('display', '', '');
	      /* Scroll so new element is at cursor. */
	      window.scroll(0, es.offsetTop + (es.offsetHeight / 2)
	          - e.clientY);
      }

      function stripsearch(str) {
	q = str.indexOf("?");
	if (q != -1)
	  str = str.substr(0, q);
	return (str);
      }

      function split() {
        page = stripsearch(location.href);
	halfway = window.scrollY + window.innerHeight / 2 - 5;
	document.write('<frameset rows="50%,*">' +
	  '<frame src="' + page + "?" + window.scrollY + '" />' +
	  '<frame src="' + page + "?" + halfway + '" />' +
	  '</frameset>');
	document.close();
      }

      function closeframe() {
	page = stripsearch(location.href);

	otherf = window.parent.frames[0];
	if (otherf == window)
	  otherf = window.parent.frames[1];

	parent.location.replace(page + "?" + otherf.scrollY);
      }
    </script>
  </head>
  <body id='SUNWwebrev'>
    <a class="print" href="javascript:print()">Print this page</a>
    <pre>
Add isDefaultCredential() method to GSSCredentialSpi
</pre>
<hr />
    <table class='cmdbox'>
      <tr>
        <td onclick='split()'>Split</td>
	<td id='close' onclick='closeframe()'>Close</td>
      </tr>
      <tr><td colspan="2" onclick='open_or_close_all(1)'>Expand all</td></tr>
      <tr><td colspan="2" onclick='open_or_close_all(0)'>Collapse all</td></tr>
    </table>

    <script type='text/javascript'>
      if (window == top)
        document.getElementById('close').style.setProperty('display', 'none', '');
    </script>
<pre><span class='subtracted'>          --- old/src/java.security.jgss/share/classes/sun/security/jgss/krb5/Krb5InitCredential.java
</span><span class='added'>          +++ new/src/java.security.jgss/share/classes/sun/security/jgss/krb5/Krb5InitCredential.java
</span></pre>
<pre id='elided1' class='elided' style='display: none'>   1    1  /*
   2    2   * Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.
   3    3   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4    4   *
   5    5   * This code is free software; you can redistribute it and/or modify it
   6    6   * under the terms of the GNU General Public License version 2 only, as
   7    7   * published by the Free Software Foundation.  Oracle designates this
   8    8   * particular file as subject to the "Classpath" exception as provided
   9    9   * by Oracle in the LICENSE file that accompanied this code.
  10   10   *
  11   11   * This code is distributed in the hope that it will be useful, but WITHOUT
  12   12   * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13   13   * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14   14   * version 2 for more details (a copy is included in the LICENSE file that
  15   15   * accompanied this code).
  16   16   *
  17   17   * You should have received a copy of the GNU General Public License version
  18   18   * 2 along with this work; if not, write to the Free Software Foundation,
  19   19   * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20   20   *
  21   21   * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22   22   * or visit www.oracle.com if you need additional information or have any
  23   23   * questions.
  24   24   */
  25   25  
  26   26  package sun.security.jgss.krb5;
  27   27  
  28   28  import org.ietf.jgss.*;
  29   29  import sun.security.jgss.GSSCaller;
  30   30  import sun.security.jgss.spi.*;
  31   31  import sun.security.krb5.*;
  32   32  import javax.security.auth.kerberos.KerberosTicket;
  33   33  import javax.security.auth.kerberos.KerberosPrincipal;
  34   34  import java.net.InetAddress;
  35   35  import java.io.IOException;
  36   36  import java.util.Date;
  37   37  import java.security.AccessController;
  38   38  import java.security.AccessControlContext;
  39   39  import java.security.PrivilegedExceptionAction;
  40   40  import java.security.PrivilegedActionException;
  41   41  
  42   42  /**
  43   43   * Implements the krb5 initiator credential element.
  44   44   *
  45   45   * @author Mayank Upadhyay
  46   46   * @author Ram Marti
  47   47   * @since 1.4
  48   48   */
</pre>
<table id='hb-elided1' class='hidebar'>
  <tr>
    <td class='active-down'
      onclick='show_n_hide_dir("elided1", "hb-elided1", "down")'>
      &darr;&nbsp;open down&nbsp;&darr;</td>
    <td class="elided-label">48 lines elided</td>
    <td class='active-up'
      onclick='show_n_hide_dir("elided1", "hb-elided1", "up")'>
      &uarr;&nbsp;open up&nbsp;&uarr;</td>
  </tr>
</table>
<pre>  49   49  
  50   50  public class Krb5InitCredential
  51   51      extends KerberosTicket
  52   52      implements Krb5CredElement {
  53   53  
  54   54      private static final long serialVersionUID = 7723415700837898232L;
  55   55  
  56   56      private Krb5NameElement name;
  57   57      private Credentials krb5Credentials;
  58   58      public KerberosTicket proxyTicket;
<span class='added'>       59 +    private boolean isDefCred;
</span>  59   60  
  60   61      private Krb5InitCredential(Krb5NameElement name,
  61   62                                 byte[] asn1Encoding,
  62   63                                 KerberosPrincipal client,
  63   64                                 KerberosPrincipal clientAlias,
  64   65                                 KerberosPrincipal server,
  65   66                                 KerberosPrincipal serverAlias,
  66   67                                 byte[] sessionKey,
  67   68                                 int keyType,
  68   69                                 boolean[] flags,
</pre>
<pre id='elided2' class='elided' style='display: none'>  69   70                                 Date authTime,
  70   71                                 Date startTime,
  71   72                                 Date endTime,
  72   73                                 Date renewTill,
  73   74                                 InetAddress[] clientAddresses)
  74   75                                 throws GSSException {
  75   76          super(asn1Encoding,
  76   77                client,
  77   78                server,
  78   79                sessionKey,
  79   80                keyType,
  80   81                flags,
</pre>
<table id='hb-elided2' class='hidebar'>
  <tr>
    <td class='active-down'
      onclick='show_n_hide_dir("elided2", "hb-elided2", "down")'>
      &darr;&nbsp;open down&nbsp;&darr;</td>
    <td class="elided-label">12 lines elided</td>
    <td class='active-up'
      onclick='show_n_hide_dir("elided2", "hb-elided2", "up")'>
      &uarr;&nbsp;open up&nbsp;&uarr;</td>
  </tr>
</table>
<pre>  81   82                authTime,
  82   83                startTime,
  83   84                endTime,
  84   85                renewTill,
  85   86                clientAddresses);
  86   87          KerberosSecrets.getJavaxSecurityAuthKerberosAccess()
  87   88                  .kerberosTicketSetClientAlias(this, clientAlias);
  88   89          KerberosSecrets.getJavaxSecurityAuthKerberosAccess()
  89   90                  .kerberosTicketSetServerAlias(this, serverAlias);
  90   91          this.name = name;
<span class='added'>       92 +        if (name == null)
       93 +            isDefCred = true;
</span>  91   94  
  92   95          try {
  93   96              // Cache this for later use by the sun.security.krb5 package.
  94   97              krb5Credentials = new Credentials(asn1Encoding,
  95   98                                                client.getName(),
  96   99                                                (clientAlias != null ?
  97  100                                                        clientAlias.getName() : null),
  98  101                                                server.getName(),
  99  102                                                (serverAlias != null ?
 100  103                                                        serverAlias.getName() : null),
</pre>
<pre id='elided3' class='elided' style='display: none'> 101  104                                                sessionKey,
 102  105                                                keyType,
 103  106                                                flags,
 104  107                                                authTime,
 105  108                                                startTime,
 106  109                                                endTime,
 107  110                                                renewTill,
 108  111                                                clientAddresses);
 109  112          } catch (KrbException e) {
 110  113              throw new GSSException(GSSException.NO_CRED, -1,
 111  114                                     e.getMessage());
 112  115          } catch (IOException e) {
 113  116              throw new GSSException(GSSException.NO_CRED, -1,
 114  117                                     e.getMessage());
 115  118          }
 116  119  
 117  120      }
 118  121  
 119  122      private Krb5InitCredential(Krb5NameElement name,
 120  123                                 Credentials delegatedCred,
 121  124                                 byte[] asn1Encoding,
 122  125                                 KerberosPrincipal client,
 123  126                                 KerberosPrincipal clientAlias,
 124  127                                 KerberosPrincipal server,
 125  128                                 KerberosPrincipal serverAlias,
 126  129                                 byte[] sessionKey,
 127  130                                 int keyType,
 128  131                                 boolean[] flags,
 129  132                                 Date authTime,
 130  133                                 Date startTime,
 131  134                                 Date endTime,
 132  135                                 Date renewTill,
 133  136                                 InetAddress[] clientAddresses)
 134  137                                 throws GSSException {
 135  138          super(asn1Encoding,
 136  139                client,
 137  140                server,
 138  141                sessionKey,
 139  142                keyType,
 140  143                flags,
 141  144                authTime,
</pre>
<table id='hb-elided3' class='hidebar'>
  <tr>
    <td class='active-down'
      onclick='show_n_hide_dir("elided3", "hb-elided3", "down")'>
      &darr;&nbsp;open down&nbsp;&darr;</td>
    <td class="elided-label">41 lines elided</td>
    <td class='active-up'
      onclick='show_n_hide_dir("elided3", "hb-elided3", "up")'>
      &uarr;&nbsp;open up&nbsp;&uarr;</td>
  </tr>
</table>
<pre> 142  145                startTime,
 143  146                endTime,
 144  147                renewTill,
 145  148                clientAddresses);
 146  149          KerberosSecrets.getJavaxSecurityAuthKerberosAccess()
 147  150                  .kerberosTicketSetClientAlias(this, clientAlias);
 148  151          KerberosSecrets.getJavaxSecurityAuthKerberosAccess()
 149  152                  .kerberosTicketSetServerAlias(this, serverAlias);
 150  153          this.name = name;
 151  154          // A delegated cred does not have all fields set. So do not try to
<span class='subtracted'> 152      -        // creat new Credentials out of the delegatedCred.
</span><span class='added'>      155 +        // creat new Credentials out of the delegatedCred.  Also, a delegated
      156 +        // credential is not a default credential.
</span> 153  157          this.krb5Credentials = delegatedCred;
 154  158      }
 155  159  
 156  160      static Krb5InitCredential getInstance(GSSCaller caller, Krb5NameElement name,
 157  161                                     int initLifetime)
 158  162          throws GSSException {
 159  163  
 160  164          KerberosTicket tgt = getTgt(caller, name, initLifetime);
 161  165          if (tgt == null)
 162  166              throw new GSSException(GSSException.NO_CRED, -1,
</pre>
<pre id='elided4' class='elided' style='display: none'> 163  167                                     "Failed to find any Kerberos tgt");
 164  168  
 165  169          if (name == null) {
 166  170              String fullName = tgt.getClient().getName();
 167  171              name = Krb5NameElement.getInstance(fullName,
 168  172                                         Krb5MechFactory.NT_GSS_KRB5_PRINCIPAL);
 169  173          }
 170  174  
 171  175          KerberosPrincipal clientAlias = KerberosSecrets
 172  176                  .getJavaxSecurityAuthKerberosAccess()
 173  177                  .kerberosTicketGetClientAlias(tgt);
 174  178          KerberosPrincipal serverAlias = KerberosSecrets
 175  179                  .getJavaxSecurityAuthKerberosAccess()
 176  180                  .kerberosTicketGetServerAlias(tgt);
 177  181          Krb5InitCredential result = new Krb5InitCredential(name,
 178  182                                        tgt.getEncoded(),
 179  183                                        tgt.getClient(),
 180  184                                        clientAlias,
 181  185                                        tgt.getServer(),
 182  186                                        serverAlias,
 183  187                                        tgt.getSessionKey().getEncoded(),
 184  188                                        tgt.getSessionKeyType(),
 185  189                                        tgt.getFlags(),
 186  190                                        tgt.getAuthTime(),
 187  191                                        tgt.getStartTime(),
 188  192                                        tgt.getEndTime(),
 189  193                                        tgt.getRenewTill(),
 190  194                                        tgt.getClientAddresses());
 191  195          result.proxyTicket = KerberosSecrets.getJavaxSecurityAuthKerberosAccess().
 192  196              kerberosTicketGetProxy(tgt);
 193  197          return result;
 194  198      }
 195  199  
 196  200      static Krb5InitCredential getInstance(Krb5NameElement name,
 197  201                                     Credentials delegatedCred)
 198  202          throws GSSException {
 199  203  
 200  204          EncryptionKey sessionKey = delegatedCred.getSessionKey();
 201  205  
 202  206          /*
 203  207           * all of the following data is optional in a KRB-CRED
 204  208           * messages. This check for each field.
 205  209           */
 206  210  
 207  211          PrincipalName cPrinc = delegatedCred.getClient();
 208  212          PrincipalName cAPrinc = delegatedCred.getClientAlias();
 209  213          PrincipalName sPrinc = delegatedCred.getServer();
 210  214          PrincipalName sAPrinc = delegatedCred.getServerAlias();
 211  215  
 212  216          KerberosPrincipal client = null;
 213  217          KerberosPrincipal clientAlias = null;
 214  218          KerberosPrincipal server = null;
 215  219          KerberosPrincipal serverAlias = null;
 216  220  
 217  221          Krb5NameElement credName = null;
 218  222  
 219  223          if (cPrinc != null) {
 220  224              String fullName = cPrinc.getName();
 221  225              credName = Krb5NameElement.getInstance(fullName,
 222  226                                 Krb5MechFactory.NT_GSS_KRB5_PRINCIPAL);
 223  227              client =  new KerberosPrincipal(fullName);
 224  228          }
 225  229  
 226  230          if (cAPrinc != null) {
 227  231              clientAlias = new KerberosPrincipal(cAPrinc.getName());
 228  232          }
 229  233  
 230  234          // XXX Compare name to credName
 231  235  
 232  236          if (sPrinc != null) {
 233  237              server =
 234  238                  new KerberosPrincipal(sPrinc.getName(),
 235  239                                          KerberosPrincipal.KRB_NT_SRV_INST);
 236  240          }
 237  241  
 238  242          if (sAPrinc != null) {
 239  243              serverAlias = new KerberosPrincipal(sAPrinc.getName());
 240  244          }
 241  245  
 242  246          return new Krb5InitCredential(credName,
 243  247                                        delegatedCred,
 244  248                                        delegatedCred.getEncoded(),
 245  249                                        client,
 246  250                                        clientAlias,
 247  251                                        server,
 248  252                                        serverAlias,
 249  253                                        sessionKey.getBytes(),
 250  254                                        sessionKey.getEType(),
 251  255                                        delegatedCred.getFlags(),
 252  256                                        delegatedCred.getAuthTime(),
 253  257                                        delegatedCred.getStartTime(),
 254  258                                        delegatedCred.getEndTime(),
 255  259                                        delegatedCred.getRenewTill(),
 256  260                                        delegatedCred.getClientAddresses());
 257  261      }
 258  262  
 259  263      /**
 260  264       * Returns the principal name for this credential. The name
 261  265       * is in mechanism specific format.
 262  266       *
 263  267       * @return GSSNameSpi representing principal name of this credential
 264  268       * @exception GSSException may be thrown
 265  269       */
 266  270      public final GSSNameSpi getName() throws GSSException {
 267  271          return name;
 268  272      }
 269  273  
 270  274      /**
 271  275       * Returns the init lifetime remaining.
 272  276       *
 273  277       * @return the init lifetime remaining in seconds
 274  278       * @exception GSSException may be thrown
 275  279       */
 276  280      public int getInitLifetime() throws GSSException {
 277  281          Date d = getEndTime();
 278  282          if (d == null) {
 279  283              return 0;
 280  284          }
 281  285          long retVal = d.getTime() - System.currentTimeMillis();
 282  286          return (int)(retVal/1000);
 283  287      }
 284  288  
 285  289      /**
 286  290       * Returns the accept lifetime remaining.
 287  291       *
 288  292       * @return the accept lifetime remaining in seconds
 289  293       * @exception GSSException may be thrown
 290  294       */
 291  295      public int getAcceptLifetime() throws GSSException {
 292  296          return 0;
 293  297      }
 294  298  
 295  299      public boolean isInitiatorCredential() throws GSSException {
 296  300          return true;
 297  301      }
 298  302  
 299  303      public boolean isAcceptorCredential() throws GSSException {
 300  304          return false;
 301  305      }
</pre>
<table id='hb-elided4' class='hidebar'>
  <tr>
    <td class='active-down'
      onclick='show_n_hide_dir("elided4", "hb-elided4", "down")'>
      &darr;&nbsp;open down&nbsp;&darr;</td>
    <td class="elided-label">139 lines elided</td>
    <td class='active-up'
      onclick='show_n_hide_dir("elided4", "hb-elided4", "up")'>
      &uarr;&nbsp;open up&nbsp;&uarr;</td>
  </tr>
</table>
<pre> 302  306  
 303  307      /**
 304  308       * Returns the oid representing the underlying credential
 305  309       * mechanism oid.
 306  310       *
 307  311       * @return the Oid for this credential mechanism
 308  312       * @exception GSSException may be thrown
 309  313       */
 310  314      public final Oid getMechanism() {
 311  315          return Krb5MechFactory.GSS_KRB5_MECH_OID;
<span class='added'>      316 +    }
      317 +
      318 +    /**
      319 +     * Returns true if the credential is a default credential.
      320 +     *
      321 +     * @return true if the credential is a default credential, else false.
      322 +     */
      323 +    public boolean isDefaultCredential() {
      324 +        return isDefCred;
</span> 312  325      }
 313  326  
 314  327      public final java.security.Provider getProvider() {
 315  328          return Krb5MechFactory.PROVIDER;
 316  329      }
 317  330  
 318  331  
 319  332      /**
 320  333       * Returns a sun.security.krb5.Credentials instance so that it maybe
 321  334       * used in that package for th Kerberos protocol.
</pre>
<pre id='elided5' class='elided' style='display: none'> 322  335       */
 323  336      Credentials getKrb5Credentials() {
 324  337          return krb5Credentials;
 325  338      }
 326  339  
 327  340      /*
 328  341       * XXX Call to this.refresh() should refresh the locally cached copy
 329  342       * of krb5Credentials also.
 330  343       */
 331  344  
 332  345      /**
 333  346       * Called to invalidate this credential element.
 334  347       */
 335  348      public void dispose() throws GSSException {
 336  349          try {
 337  350              destroy();
 338  351          } catch (javax.security.auth.DestroyFailedException e) {
 339  352              GSSException gssException =
 340  353                  new GSSException(GSSException.FAILURE, -1,
 341  354                   "Could not destroy credentials - " + e.getMessage());
 342  355              gssException.initCause(e);
 343  356          }
 344  357      }
 345  358  
 346  359      // XXX call to this.destroy() should destroy the locally cached copy
 347  360      // of krb5Credentials and then call super.destroy().
 348  361  
 349  362      private static KerberosTicket getTgt(GSSCaller caller, Krb5NameElement name,
 350  363                                                   int initLifetime)
 351  364          throws GSSException {
 352  365  
 353  366          final String clientPrincipal;
 354  367  
 355  368          /*
 356  369           * Find the TGT for the realm that the client is in. If the client
 357  370           * name is not available, then use the default realm.
 358  371           */
 359  372          if (name != null) {
 360  373              clientPrincipal = (name.getKrb5PrincipalName()).getName();
 361  374          } else {
 362  375              clientPrincipal = null;
 363  376          }
 364  377  
 365  378          final AccessControlContext acc = AccessController.getContext();
 366  379  
 367  380          try {
 368  381              final GSSCaller realCaller = (caller == GSSCaller.CALLER_UNKNOWN)
 369  382                                     ? GSSCaller.CALLER_INITIATE
 370  383                                     : caller;
 371  384              return AccessController.doPrivileged(
 372  385                  new PrivilegedExceptionAction&lt;KerberosTicket&gt;() {
 373  386                  public KerberosTicket run() throws Exception {
 374  387                      // It's OK to use null as serverPrincipal. TGT is almost
 375  388                      // the first ticket for a principal and we use list.
 376  389                      return Krb5Util.getInitialTicket(
 377  390                          realCaller,
 378  391                          clientPrincipal, acc);
 379  392                          }});
 380  393          } catch (PrivilegedActionException e) {
 381  394              GSSException ge =
 382  395                  new GSSException(GSSException.NO_CRED, -1,
 383  396                      "Attempt to obtain new INITIATE credentials failed!" +
 384  397                      " (" + e.getMessage() + ")");
 385  398              ge.initCause(e.getException());
 386  399              throw ge;
 387  400          }
 388  401      }
 389  402  
 390  403      @Override
 391  404      public GSSCredentialSpi impersonate(GSSNameSpi name) throws GSSException {
 392  405          try {
 393  406              Krb5NameElement kname = (Krb5NameElement)name;
 394  407              Credentials newCred = Credentials.acquireS4U2selfCreds(
 395  408                      kname.getKrb5PrincipalName(), krb5Credentials);
 396  409              return new Krb5ProxyCredential(this, kname, newCred.getTicket());
 397  410          } catch (IOException | KrbException ke) {
 398  411              GSSException ge =
 399  412                  new GSSException(GSSException.FAILURE, -1,
 400  413                      "Attempt to obtain S4U2self credentials failed!");
 401  414              ge.initCause(ke);
 402  415              throw ge;
 403  416          }
 404  417      }
 405  418  }
</pre>
<table id='hb-elided5' class='hidebar'>
  <tr>
    <td class='active-down'
      onclick='show_n_hide_dir("elided5", "hb-elided5", "down")'>
      &darr;&nbsp;open down&nbsp;&darr;</td>
    <td class="elided-label">84 lines elided</td>
    <td class='active-up'
      onclick='show_n_hide_dir("elided5", "hb-elided5", "up")'>
      &uarr;&nbsp;open up&nbsp;&uarr;</td>
  </tr>
</table>
<pre id='linerefpre'><span id='lineref'>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span></pre>
    <br clear="all" />
    <br />

    <script type="text/javascript">
      /* Assign event handlers and widths. */
      var w = document.getElementById('lineref').offsetWidth;
      for (var i = 1; i <= 5; ++i) {
	      var e = document.getElementById("elided" + i);
	      e.onclick = handle_click;
              e.style.setProperty('width', w + "px", '');

	      e = document.getElementById("hb-elided" + i);
              e.style.setProperty('width', w + "px", '');
      }

      /* Hide our line size reference. */
      document.getElementById('linerefpre').style.setProperty('display',
          'none', '');

      /* Scroll as indicated. */
      str = location.search;
      s = str.substring(1, str.length);
      if (s > 0)
        window.scroll(0, s);

      function open_or_close_all(open) {
	      for (var i = 1; i <= 5; ++i) {
		      var e = document.getElementById("hb-elided" + i);
		      e.style.setProperty("display", open ? "none" : "", "");

		      e = document.getElementById("elided" + i);
		      e.style.setProperty("display", open ? "" : "none", "");
	      }
      }
    </script>
  </body>
</html>
