<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>ws Wdiff src/java.security.jgss/share/native/libj2gss/gssapi.h</title>

    <meta http-equiv="cache-control" content="no-cache" />

    <style type='text/css' media='screen'>
      pre	{ margin: 2px; }

      body	{ background-color: #eeeeee; }

      hr	{ border: none 0; border-top: 1px solid #aaa; height: 1px; }

      .subtracted { color: brown }
      .added	{ color: blue }

      .elided	{ border: 1px solid #444; cursor: pointer; margin: 1px }

      table.hidebar { border: 1px solid #ff9900; background-color: #eee;
      		  text-align: center; border-collapse: collapse; }

      .hidebar td.active-down { border: 1px solid #ff9900;
		border-right: 1px solid #ccc; cursor: s-resize }

      .hidebar td.active-down:hover { background-color: #ffcc99; }

      .hidebar td.active-up { border: 1px solid #ff9900; cursor: n-resize;
		border-left: 1px solid #ccc; }

      .hidebar td.active-up:hover { background-color: #ffcc99; }

      .hidebar td.elided-label { font-style: italic; width: 12em; }

      .cmdbox	{ position: fixed; top: 0; right: 0;
	          border-left: solid 1px #444;
	          border-bottom: solid 1px #444;
      		  background-color: #ccc; text-align: center }

      .cmdbox td { background-color: #eee; border: 1px #444 outset;
		   cursor: pointer; padding: 3px 4px; }
      .cmdbox td:hover { background-color: #ffcc99;
 		outline: thin solid #ff9900; }

      a:hover { background-color: #ffcc99; }

      a.print { font-size: x-small; }
    </style>

    <style type='text/css' media='print'>
	pre { font-family: courier, monospace; font-size: 0.8em; }
	.cmdbox { display: none; }
        a.print { display: none; }
	.hidebar td.active-down { display: none; }
	.hidebar td.active-up { display: none; }
        .hidebar td.elided-label { font-style: italic; font-size: small; }
	table.hidebar { border: none; border-bottom: 1px dotted #000000; }
	span.added { font-weight: bold;
	         background-color: #eee; width: 100%; display: block; }
	span.subtracted { font-style: italic;
		 background-color: #eee; width: 100%; display: block; }
	.elided { display: none; }
        hr { border: none 0; border-top: 1px solid #aaa; height: 1px; }
    </style>

    <script type="text/javascript">
      function show_n_hide_dir(id_to_show, id_to_hide, dir) {
	      var elt_to_show = document.getElementById(id_to_show);
	      var elt_to_hide = document.getElementById(id_to_hide);
	      // When we're opening up, we need to make the bottoms of the
	      // elements appear to be the same.  So our invariant should be
	      // elt.offsetBottom - window.scrollY.
	      var preinvar = elt_to_hide.offsetHeight - window.scrollY;
	      elt_to_show.style.setProperty('display', '', '');
	      elt_to_hide.style.setProperty('display', 'none', '');
	      if (dir == 'up') {
		      var postinvar = elt_to_show.offsetHeight - window.scrollY;
		      window.scrollBy(0, postinvar - preinvar);
	      }
      }

      function handle_click(e) {
	      var eh = e.target;
	      var es = document.getElementById("hb-" + e.target.id);
	      eh.style.setProperty('display', 'none', '');
	      es.style.setProperty('display', '', '');
	      /* Scroll so new element is at cursor. */
	      window.scroll(0, es.offsetTop + (es.offsetHeight / 2)
	          - e.clientY);
      }

      function stripsearch(str) {
	q = str.indexOf("?");
	if (q != -1)
	  str = str.substr(0, q);
	return (str);
      }

      function split() {
        page = stripsearch(location.href);
	halfway = window.scrollY + window.innerHeight / 2 - 5;
	document.write('<frameset rows="50%,*">' +
	  '<frame src="' + page + "?" + window.scrollY + '" />' +
	  '<frame src="' + page + "?" + halfway + '" />' +
	  '</frameset>');
	document.close();
      }

      function closeframe() {
	page = stripsearch(location.href);

	otherf = window.parent.frames[0];
	if (otherf == window)
	  otherf = window.parent.frames[1];

	parent.location.replace(page + "?" + otherf.scrollY);
      }
    </script>
  </head>
  <body id='SUNWwebrev'>
    <a class="print" href="javascript:print()">Print this page</a>
    <pre>
Add JGSS JNI bindings for gss cred store functions
Add createCredential() with password
Also avoid memory allocation in newGSSOIDSet() renamed to makeGSSOIDset()
which now takes a singleton set argument and either assigns the requested
OID or with SPNEGO returns a static list of all the supported mechs. With
this we no longer need deleteGSSOIDSet().
Add getLocalName() GSSName method
</pre>
<hr />
    <table class='cmdbox'>
      <tr>
        <td onclick='split()'>Split</td>
	<td id='close' onclick='closeframe()'>Close</td>
      </tr>
      <tr><td colspan="2" onclick='open_or_close_all(1)'>Expand all</td></tr>
      <tr><td colspan="2" onclick='open_or_close_all(0)'>Collapse all</td></tr>
    </table>

    <script type='text/javascript'>
      if (window == top)
        document.getElementById('close').style.setProperty('display', 'none', '');
    </script>
<pre><span class='subtracted'>          --- old/src/java.security.jgss/share/native/libj2gss/gssapi.h
</span><span class='added'>          +++ new/src/java.security.jgss/share/native/libj2gss/gssapi.h
</span></pre>
<pre id='elided1' class='elided' style='display: none'>   1    1  /*
   2    2   * Copyright (c) 2005, 2019, Oracle and/or its affiliates. All rights reserved.
   3    3   * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4    4   *
   5    5   * This code is free software; you can redistribute it and/or modify it
   6    6   * under the terms of the GNU General Public License version 2 only, as
   7    7   * published by the Free Software Foundation.  Oracle designates this
   8    8   * particular file as subject to the "Classpath" exception as provided
   9    9   * by Oracle in the LICENSE file that accompanied this code.
  10   10   *
  11   11   * This code is distributed in the hope that it will be useful, but WITHOUT
  12   12   * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13   13   * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14   14   * version 2 for more details (a copy is included in the LICENSE file that
  15   15   * accompanied this code).
  16   16   *
  17   17   * You should have received a copy of the GNU General Public License version
  18   18   * 2 along with this work; if not, write to the Free Software Foundation,
  19   19   * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20   20   *
  21   21   * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22   22   * or visit www.oracle.com if you need additional information or have any
  23   23   * questions.
  24   24   */
  25   25  
  26   26  /* This is the gssapi.h prologue. */
  27   27  /* It contains some choice pieces of autoconf.h */
  28   28  #define GSS_SIZEOF_INT 4
  29   29  #define GSS_SIZEOF_LONG 4
  30   30  #define GSS_SIZEOF_SHORT 2
  31   31  
  32   32  #ifndef _GSSAPI_H_
  33   33  #define _GSSAPI_H_
  34   34  
  35   35  #if defined(__MACH__) &amp;&amp; defined(__APPLE__)
  36   36  #       include &lt;TargetConditionals.h&gt;
  37   37  #       if TARGET_RT_MAC_CFM
  38   38  #               error "Use KfM 4.0 SDK headers for CFM compilation."
  39   39  #       endif
  40   40  #endif
  41   41  
  42   42  #ifdef __cplusplus
  43   43  extern "C" {
  44   44  #endif /* __cplusplus */
  45   45  
  46   46  #if TARGET_OS_MAC
  47   47  #    pragma pack(push,2)
  48   48  #endif
  49   49  
  50   50  /*
  51   51   * First, include stddef.h to get size_t defined.
  52   52   */
  53   53  #include &lt;stddef.h&gt;
  54   54  
  55   55  /*
  56   56   * POSIX says that sys/types.h is where size_t is defined.
  57   57   */
  58   58  #include &lt;sys/types.h&gt;
  59   59  
  60   60  struct gss_name_struct;
  61   61  typedef struct gss_name_struct * gss_name_t;
  62   62  typedef const struct gss_name_struct *gss_const_name_t;
  63   63  
  64   64  struct gss_cred_id_struct;
  65   65  typedef struct gss_cred_id_struct * gss_cred_id_t;
  66   66  typedef const struct gss_cred_id_struct *gss_const_cred_id_t;
  67   67  
  68   68  struct gss_ctx_id_struct;
  69   69  typedef struct gss_ctx_id_struct * gss_ctx_id_t;
  70   70  typedef const struct gss_ctx_id_struct *gss_const_ctx_id_t;
  71   71  
  72   72  /*
  73   73   * The following type must be defined as the smallest natural unsigned integer
  74   74   * supported by the platform that has at least 32 bits of precision.
  75   75   */
  76   76  #if (GSS_SIZEOF_SHORT == 4)
  77   77  typedef unsigned short gss_uint32;
  78   78  typedef short gss_int32;
  79   79  #elif (GSS_SIZEOF_INT == 4)
  80   80  typedef unsigned int gss_uint32;
  81   81  typedef int gss_int32;
  82   82  #elif (GSS_SIZEOF_LONG == 4)
  83   83  typedef unsigned long gss_uint32;
  84   84  typedef long gss_int32;
  85   85  #endif
  86   86  
  87   87  typedef gss_uint32      OM_uint32;
  88   88  
  89   89  typedef struct gss_OID_desc_struct {
  90   90        OM_uint32 length;
  91   91        void *elements;
  92   92  } gss_OID_desc, *gss_OID;
  93   93  typedef const gss_OID_desc * gss_const_OID;
  94   94  
  95   95  typedef struct gss_OID_set_desc_struct  {
  96   96        size_t  count;
  97   97        gss_OID elements;
  98   98  } gss_OID_set_desc, *gss_OID_set;
  99   99  typedef const gss_OID_set_desc * gss_const_OID_set;
 100  100  
 101  101  typedef struct gss_buffer_desc_struct {
 102  102        size_t length;
 103  103        void *value;
 104  104  } gss_buffer_desc, *gss_buffer_t;
 105  105  typedef const gss_buffer_desc * gss_const_buffer_t;
 106  106  
 107  107  typedef struct gss_channel_bindings_struct {
 108  108        OM_uint32 initiator_addrtype;
 109  109        gss_buffer_desc initiator_address;
 110  110        OM_uint32 acceptor_addrtype;
 111  111        gss_buffer_desc acceptor_address;
</pre>
<table id='hb-elided1' class='hidebar'>
  <tr>
    <td class='active-down'
      onclick='show_n_hide_dir("elided1", "hb-elided1", "down")'>
      &darr;&nbsp;open down&nbsp;&darr;</td>
    <td class="elided-label">111 lines elided</td>
    <td class='active-up'
      onclick='show_n_hide_dir("elided1", "hb-elided1", "up")'>
      &uarr;&nbsp;open up&nbsp;&uarr;</td>
  </tr>
</table>
<pre> 112  112        gss_buffer_desc application_data;
 113  113  } *gss_channel_bindings_t;
 114  114  typedef const struct gss_channel_bindings_struct *gss_const_channel_bindings_t;
 115  115  
 116  116  /*
 117  117   * For now, define a QOP-type as an OM_uint32
 118  118   */
 119  119  typedef OM_uint32       gss_qop_t;
 120  120  typedef int             gss_cred_usage_t;
 121  121  
<span class='added'>      122 +/* Credential store extensions */
      123 +typedef struct gss_key_value_element_struct {
      124 +    const char *key;
      125 +    const char *value;
      126 +} gss_key_value_element_desc;
      127 +
      128 +typedef struct gss_key_value_set_struct {
      129 +    OM_uint32 count; /* should be size_t, but for MIT compat */
      130 +    gss_key_value_element_desc *elements;
      131 +} gss_key_value_set_desc, *gss_key_value_set_t;
      132 +
      133 +typedef const gss_key_value_set_desc *gss_const_key_value_set_t;
      134 +
</span> 122  135  /*
 123  136   * Flag bits for context-level services.
 124  137   */
 125  138  #define GSS_C_DELEG_FLAG 1
 126  139  #define GSS_C_MUTUAL_FLAG 2
 127  140  #define GSS_C_REPLAY_FLAG 4
 128  141  #define GSS_C_SEQUENCE_FLAG 8
 129  142  #define GSS_C_CONF_FLAG 16
 130  143  #define GSS_C_INTEG_FLAG 32
 131  144  #define GSS_C_ANON_FLAG 64
</pre>
<pre id='elided2' class='elided' style='display: none'> 132  145  #define GSS_C_PROT_READY_FLAG 128
 133  146  #define GSS_C_TRANS_FLAG 256
 134  147  #define GSS_C_DELEG_POLICY_FLAG 32768
 135  148  
 136  149  /*
 137  150   * Credential usage options
 138  151   */
 139  152  #define GSS_C_BOTH 0
 140  153  #define GSS_C_INITIATE 1
 141  154  #define GSS_C_ACCEPT 2
 142  155  
 143  156  /*
 144  157   * Status code types for gss_display_status
 145  158   */
 146  159  #define GSS_C_GSS_CODE 1
 147  160  #define GSS_C_MECH_CODE 2
 148  161  
 149  162  /*
 150  163   * The constant definitions for channel-bindings address families
 151  164   */
 152  165  #define GSS_C_AF_UNSPEC     0
 153  166  #define GSS_C_AF_LOCAL      1
 154  167  #define GSS_C_AF_INET       2
 155  168  #define GSS_C_AF_IMPLINK    3
 156  169  #define GSS_C_AF_PUP        4
 157  170  #define GSS_C_AF_CHAOS      5
 158  171  #define GSS_C_AF_NS         6
 159  172  #define GSS_C_AF_NBS        7
 160  173  #define GSS_C_AF_ECMA       8
 161  174  #define GSS_C_AF_DATAKIT    9
 162  175  #define GSS_C_AF_CCITT      10
 163  176  #define GSS_C_AF_SNA        11
 164  177  #define GSS_C_AF_DECnet     12
 165  178  #define GSS_C_AF_DLI        13
 166  179  #define GSS_C_AF_LAT        14
 167  180  #define GSS_C_AF_HYLINK     15
 168  181  #define GSS_C_AF_APPLETALK  16
 169  182  #define GSS_C_AF_BSC        17
 170  183  #define GSS_C_AF_DSS        18
 171  184  #define GSS_C_AF_OSI        19
 172  185  #define GSS_C_AF_X25        21
 173  186  
 174  187  #define GSS_C_AF_NULLADDR   255
 175  188  
 176  189  /*
 177  190   * Various Null values.
 178  191   */
 179  192  #define GSS_C_NO_NAME ((gss_name_t) 0)
 180  193  #define GSS_C_NO_BUFFER ((gss_buffer_t) 0)
 181  194  #define GSS_C_NO_OID ((gss_OID) 0)
 182  195  #define GSS_C_NO_OID_SET ((gss_OID_set) 0)
 183  196  #define GSS_C_NO_CONTEXT ((gss_ctx_id_t) 0)
 184  197  #define GSS_C_NO_CREDENTIAL ((gss_cred_id_t) 0)
 185  198  #define GSS_C_NO_CHANNEL_BINDINGS ((gss_channel_bindings_t) 0)
 186  199  #define GSS_C_EMPTY_BUFFER {0, NULL}
 187  200  
 188  201  /*
 189  202   * Some alternate names for a couple of the above values.  These are defined
 190  203   * for V1 compatibility.
 191  204   */
 192  205  #define GSS_C_NULL_OID          GSS_C_NO_OID
 193  206  #define GSS_C_NULL_OID_SET      GSS_C_NO_OID_SET
 194  207  
 195  208  /*
 196  209   * Define the default Quality of Protection for per-message services.  Note
 197  210   * that an implementation that offers multiple levels of QOP may either reserve
 198  211   * a value (for example zero, as assumed here) to mean "default protection", or
 199  212   * alternatively may simply equate GSS_C_QOP_DEFAULT to a specific explicit
 200  213   * QOP value.  However a value of 0 should always be interpreted by a GSSAPI
 201  214   * implementation as a request for the default protection level.
 202  215   */
 203  216  #define GSS_C_QOP_DEFAULT 0
 204  217  
 205  218  /*
 206  219   * Expiration time of 2^32-1 seconds means infinite lifetime for a
 207  220   * credential or security context
 208  221   */
 209  222  #define GSS_C_INDEFINITE ((OM_uint32) 0xfffffffful)
 210  223  
 211  224  
 212  225  /* Major status codes */
 213  226  
 214  227  #define GSS_S_COMPLETE 0
 215  228  
 216  229  /*
 217  230   * Some "helper" definitions to make the status code macros obvious.
 218  231   */
 219  232  #define GSS_C_CALLING_ERROR_OFFSET 24
 220  233  #define GSS_C_ROUTINE_ERROR_OFFSET 16
 221  234  #define GSS_C_SUPPLEMENTARY_OFFSET 0
 222  235  #define GSS_C_CALLING_ERROR_MASK ((OM_uint32) 0377ul)
 223  236  #define GSS_C_ROUTINE_ERROR_MASK ((OM_uint32) 0377ul)
 224  237  #define GSS_C_SUPPLEMENTARY_MASK ((OM_uint32) 0177777ul)
 225  238  
 226  239  /*
 227  240   * The macros that test status codes for error conditions.  Note that the
 228  241   * GSS_ERROR() macro has changed slightly from the V1 GSSAPI so that it now
 229  242   * evaluates its argument only once.
 230  243   */
 231  244  #define GSS_CALLING_ERROR(x) \
 232  245    ((x) &amp; (GSS_C_CALLING_ERROR_MASK &lt;&lt; GSS_C_CALLING_ERROR_OFFSET))
 233  246  #define GSS_ROUTINE_ERROR(x) \
 234  247    ((x) &amp; (GSS_C_ROUTINE_ERROR_MASK &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET))
 235  248  #define GSS_SUPPLEMENTARY_INFO(x) \
 236  249    ((x) &amp; (GSS_C_SUPPLEMENTARY_MASK &lt;&lt; GSS_C_SUPPLEMENTARY_OFFSET))
 237  250  #define GSS_ERROR(x) \
 238  251    ((x) &amp; ((GSS_C_CALLING_ERROR_MASK &lt;&lt; GSS_C_CALLING_ERROR_OFFSET) | \
 239  252            (GSS_C_ROUTINE_ERROR_MASK &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)))
 240  253  
 241  254  /*
 242  255   * Now the actual status code definitions
 243  256   */
 244  257  
 245  258  /*
 246  259   * Calling errors:
 247  260   */
 248  261  #define GSS_S_CALL_INACCESSIBLE_READ \
 249  262                               (((OM_uint32) 1ul) &lt;&lt; GSS_C_CALLING_ERROR_OFFSET)
 250  263  #define GSS_S_CALL_INACCESSIBLE_WRITE \
 251  264                               (((OM_uint32) 2ul) &lt;&lt; GSS_C_CALLING_ERROR_OFFSET)
 252  265  #define GSS_S_CALL_BAD_STRUCTURE \
 253  266                               (((OM_uint32) 3ul) &lt;&lt; GSS_C_CALLING_ERROR_OFFSET)
 254  267  
 255  268  /*
 256  269   * Routine errors:
 257  270   */
 258  271  #define GSS_S_BAD_MECH (((OM_uint32) 1ul) &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)
 259  272  #define GSS_S_BAD_NAME (((OM_uint32) 2ul) &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)
 260  273  #define GSS_S_BAD_NAMETYPE (((OM_uint32) 3ul) &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)
 261  274  #define GSS_S_BAD_BINDINGS (((OM_uint32) 4ul) &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)
 262  275  #define GSS_S_BAD_STATUS (((OM_uint32) 5ul) &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)
 263  276  #define GSS_S_BAD_SIG (((OM_uint32) 6ul) &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)
 264  277  #define GSS_S_NO_CRED (((OM_uint32) 7ul) &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)
 265  278  #define GSS_S_NO_CONTEXT (((OM_uint32) 8ul) &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)
 266  279  #define GSS_S_DEFECTIVE_TOKEN (((OM_uint32) 9ul) &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)
 267  280  #define GSS_S_DEFECTIVE_CREDENTIAL \
 268  281       (((OM_uint32) 10ul) &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)
 269  282  #define GSS_S_CREDENTIALS_EXPIRED \
 270  283       (((OM_uint32) 11ul) &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)
 271  284  #define GSS_S_CONTEXT_EXPIRED \
 272  285       (((OM_uint32) 12ul) &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)
 273  286  #define GSS_S_FAILURE (((OM_uint32) 13ul) &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)
 274  287  #define GSS_S_BAD_QOP (((OM_uint32) 14ul) &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)
 275  288  #define GSS_S_UNAUTHORIZED (((OM_uint32) 15ul) &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)
 276  289  #define GSS_S_UNAVAILABLE (((OM_uint32) 16ul) &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)
 277  290  #define GSS_S_DUPLICATE_ELEMENT \
 278  291       (((OM_uint32) 17ul) &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)
 279  292  #define GSS_S_NAME_NOT_MN \
 280  293       (((OM_uint32) 18ul) &lt;&lt; GSS_C_ROUTINE_ERROR_OFFSET)
 281  294  
 282  295  /*
 283  296   * Supplementary info bits:
 284  297   */
 285  298  #define GSS_S_CONTINUE_NEEDED (1 &lt;&lt; (GSS_C_SUPPLEMENTARY_OFFSET + 0))
 286  299  #define GSS_S_DUPLICATE_TOKEN (1 &lt;&lt; (GSS_C_SUPPLEMENTARY_OFFSET + 1))
 287  300  #define GSS_S_OLD_TOKEN (1 &lt;&lt; (GSS_C_SUPPLEMENTARY_OFFSET + 2))
 288  301  #define GSS_S_UNSEQ_TOKEN (1 &lt;&lt; (GSS_C_SUPPLEMENTARY_OFFSET + 3))
 289  302  #define GSS_S_GAP_TOKEN (1 &lt;&lt; (GSS_C_SUPPLEMENTARY_OFFSET + 4))
 290  303  
 291  304  
 292  305  /*
 293  306   * Finally, function prototypes for the GSSAPI routines.
 294  307   */
 295  308  
 296  309  #if defined (_WIN32) &amp;&amp; defined (_MSC_VER)
 297  310  # ifdef GSS_DLL_FILE
 298  311  #  define GSS_DLLIMP __declspec(dllexport)
 299  312  # else
 300  313  #  define GSS_DLLIMP __declspec(dllimport)
 301  314  # endif
 302  315  #else
 303  316  # define GSS_DLLIMP
 304  317  #endif
 305  318  
 306  319  /* Reserved static storage for GSS_oids.  Comments are quotes from RFC 2744.
 307  320   *
 308  321   * The implementation must reserve static storage for a
 309  322   * gss_OID_desc object containing the value
 310  323   * {10, (void *)"\x2a\x86\x48\x86\xf7\x12\x01\x02\x01\x01"},
 311  324   * corresponding to an object-identifier value of
 312  325   * {iso(1) member-body(2) United States(840) mit(113554)
 313  326   * infosys(1) gssapi(2) generic(1) user_name(1)}.  The constant
 314  327   * GSS_C_NT_USER_NAME should be initialized to point
 315  328   * to that gss_OID_desc.
 316  329   */
 317  330  GSS_DLLIMP extern gss_OID GSS_C_NT_USER_NAME;
 318  331  
 319  332  /*
 320  333   * The implementation must reserve static storage for a
 321  334   * gss_OID_desc object containing the value
 322  335   * {10, (void *)"\x2a\x86\x48\x86\xf7\x12\x01\x02\x01\x02"},
 323  336   * corresponding to an object-identifier value of
 324  337   * {iso(1) member-body(2) United States(840) mit(113554)
 325  338   * infosys(1) gssapi(2) generic(1) machine_uid_name(2)}.
 326  339   * The constant GSS_C_NT_MACHINE_UID_NAME should be
 327  340   * initialized to point to that gss_OID_desc.
 328  341   */
 329  342  GSS_DLLIMP extern gss_OID GSS_C_NT_MACHINE_UID_NAME;
 330  343  
 331  344  /*
 332  345   * The implementation must reserve static storage for a
 333  346   * gss_OID_desc object containing the value
 334  347   * {10, (void *)"\x2a\x86\x48\x86\xf7\x12\x01\x02\x01\x03"},
 335  348   * corresponding to an object-identifier value of
 336  349   * {iso(1) member-body(2) United States(840) mit(113554)
 337  350   * infosys(1) gssapi(2) generic(1) string_uid_name(3)}.
 338  351   * The constant GSS_C_NT_STRING_UID_NAME should be
 339  352   * initialized to point to that gss_OID_desc.
 340  353   */
 341  354  GSS_DLLIMP extern gss_OID GSS_C_NT_STRING_UID_NAME;
 342  355  
 343  356  /*
 344  357   * The implementation must reserve static storage for a
 345  358   * gss_OID_desc object containing the value
 346  359   * {6, (void *)"\x2b\x06\x01\x05\x06\x02"},
 347  360   * corresponding to an object-identifier value of
 348  361   * {iso(1) org(3) dod(6) internet(1) security(5)
 349  362   * nametypes(6) gss-host-based-services(2)).  The constant
 350  363   * GSS_C_NT_HOSTBASED_SERVICE_X should be initialized to point
 351  364   * to that gss_OID_desc.  This is a deprecated OID value, and
 352  365   * implementations wishing to support hostbased-service names
 353  366   * should instead use the GSS_C_NT_HOSTBASED_SERVICE OID,
 354  367   * defined below, to identify such names;
 355  368   * GSS_C_NT_HOSTBASED_SERVICE_X should be accepted a synonym
 356  369   * for GSS_C_NT_HOSTBASED_SERVICE when presented as an input
 357  370   * parameter, but should not be emitted by GSS-API
 358  371   * implementations
 359  372   */
 360  373  GSS_DLLIMP extern gss_OID GSS_C_NT_HOSTBASED_SERVICE_X;
 361  374  
 362  375  /*
 363  376   * The implementation must reserve static storage for a
 364  377   * gss_OID_desc object containing the value
 365  378   * {10, (void *)"\x2a\x86\x48\x86\xf7\x12"
 366  379   *              "\x01\x02\x01\x04"}, corresponding to an
 367  380   * object-identifier value of {iso(1) member-body(2)
 368  381   * Unites States(840) mit(113554) infosys(1) gssapi(2)
 369  382   * generic(1) service_name(4)}.  The constant
 370  383   * GSS_C_NT_HOSTBASED_SERVICE should be initialized
 371  384   * to point to that gss_OID_desc.
 372  385   */
 373  386  GSS_DLLIMP extern gss_OID GSS_C_NT_HOSTBASED_SERVICE;
 374  387  
 375  388  /*
 376  389   * The implementation must reserve static storage for a
 377  390   * gss_OID_desc object containing the value
 378  391   * {6, (void *)"\x2b\x06\01\x05\x06\x03"},
 379  392   * corresponding to an object identifier value of
 380  393   * {1(iso), 3(org), 6(dod), 1(internet), 5(security),
 381  394   * 6(nametypes), 3(gss-anonymous-name)}.  The constant
 382  395   * and GSS_C_NT_ANONYMOUS should be initialized to point
 383  396   * to that gss_OID_desc.
 384  397   */
 385  398  GSS_DLLIMP extern gss_OID GSS_C_NT_ANONYMOUS;
 386  399  
 387  400  
 388  401  /*
 389  402   * The implementation must reserve static storage for a
 390  403   * gss_OID_desc object containing the value
 391  404   * {6, (void *)"\x2b\x06\x01\x05\x06\x04"},
 392  405   * corresponding to an object-identifier value of
 393  406   * {1(iso), 3(org), 6(dod), 1(internet), 5(security),
 394  407   * 6(nametypes), 4(gss-api-exported-name)}.  The constant
 395  408   * GSS_C_NT_EXPORT_NAME should be initialized to point
 396  409   * to that gss_OID_desc.
 397  410   */
 398  411  GSS_DLLIMP extern gss_OID GSS_C_NT_EXPORT_NAME;
 399  412  
 400  413  
 401  414  /* Function Prototypes */
 402  415  
 403  416  GSS_DLLIMP OM_uint32 gss_acquire_cred(
 404  417          OM_uint32 *,            /* minor_status */
 405  418          gss_const_name_t,       /* desired_name */
 406  419          OM_uint32,              /* time_req */
 407  420          gss_const_OID_set,      /* desired_mechs */
 408  421          gss_cred_usage_t,       /* cred_usage */
 409  422          gss_cred_id_t *,        /* output_cred_handle */
 410  423          gss_OID_set *,          /* actual_mechs */
 411  424          OM_uint32 *             /* time_rec */
 412  425  );
 413  426  
 414  427  GSS_DLLIMP OM_uint32 gss_release_cred(
 415  428          OM_uint32 *,            /* minor_status */
 416  429          gss_cred_id_t *         /* cred_handle */
 417  430  );
 418  431  
 419  432  GSS_DLLIMP OM_uint32 gss_init_sec_context(
 420  433          OM_uint32 *,            /* minor_status */
 421  434          gss_const_cred_id_t,    /* claimant_cred_handle */
 422  435          gss_ctx_id_t *,         /* context_handle */
 423  436          gss_const_name_t,       /* target_name */
 424  437          gss_const_OID,          /* mech_type */
 425  438          OM_uint32,              /* req_flags */
 426  439          OM_uint32,              /* time_req */
 427  440          gss_const_channel_bindings_t, /* input_chan_bindings */
 428  441          gss_const_buffer_t,     /* input_token */
 429  442          gss_OID *,              /* actual_mech_type */
 430  443          gss_buffer_t,           /* output_token */
 431  444          OM_uint32 *,            /* ret_flags */
 432  445          OM_uint32 *             /* time_rec */
 433  446  );
 434  447  
 435  448  GSS_DLLIMP OM_uint32 gss_accept_sec_context(
 436  449          OM_uint32 *,            /* minor_status */
 437  450          gss_ctx_id_t *,         /* context_handle */
 438  451          gss_const_cred_id_t,    /* acceptor_cred_handle */
 439  452          gss_const_buffer_t,     /* input_token_buffer */
 440  453          gss_const_channel_bindings_t, /* input_chan_bindings */
 441  454          gss_name_t *,           /* src_name */
 442  455          gss_OID *,              /* mech_type */
 443  456          gss_buffer_t,           /* output_token */
 444  457          OM_uint32 *,            /* ret_flags */
 445  458          OM_uint32 *,            /* time_rec */
 446  459          gss_cred_id_t *         /* delegated_cred_handle */
 447  460  );
 448  461  
 449  462  GSS_DLLIMP OM_uint32 gss_process_context_token(
 450  463          OM_uint32 *,            /* minor_status */
 451  464          gss_const_ctx_id_t,     /* context_handle */
 452  465          gss_const_buffer_t      /* token_buffer */
 453  466  );
 454  467  
 455  468  GSS_DLLIMP OM_uint32 gss_delete_sec_context(
 456  469          OM_uint32 *,            /* minor_status */
 457  470          gss_ctx_id_t *,         /* context_handle */
 458  471          gss_buffer_t            /* output_token */
 459  472  );
 460  473  
 461  474  GSS_DLLIMP OM_uint32 gss_context_time(
 462  475          OM_uint32 *,            /* minor_status */
 463  476          gss_const_ctx_id_t,     /* context_handle */
 464  477          OM_uint32 *             /* time_rec */
 465  478  );
 466  479  
 467  480  /* New for V2 */
 468  481  GSS_DLLIMP OM_uint32 gss_get_mic(
 469  482          OM_uint32 *,            /* minor_status */
 470  483          gss_const_ctx_id_t,     /* context_handle */
 471  484          gss_qop_t,              /* qop_req */
 472  485          gss_const_buffer_t,     /* message_buffer */
 473  486          gss_buffer_t            /* message_token */
 474  487  );
 475  488  
 476  489  /* New for V2 */
 477  490  GSS_DLLIMP OM_uint32 gss_verify_mic(
 478  491          OM_uint32 *,            /* minor_status */
 479  492          gss_const_ctx_id_t,     /* context_handle */
 480  493          gss_const_buffer_t,     /* message_buffer */
 481  494          gss_const_buffer_t,     /* message_token */
 482  495          gss_qop_t *             /* qop_state */
 483  496  );
 484  497  
 485  498  /* New for V2 */
 486  499  GSS_DLLIMP OM_uint32 gss_wrap(
 487  500          OM_uint32 *,            /* minor_status */
 488  501          gss_const_ctx_id_t,     /* context_handle */
 489  502          int,                    /* conf_req_flag */
 490  503          gss_qop_t,              /* qop_req */
 491  504          gss_const_buffer_t,     /* input_message_buffer */
 492  505          int *,                  /* conf_state */
 493  506          gss_buffer_t            /* output_message_buffer */
 494  507  );
 495  508  
 496  509  /* New for V2 */
 497  510  GSS_DLLIMP OM_uint32 gss_unwrap(
 498  511          OM_uint32 *,            /* minor_status */
 499  512          gss_const_ctx_id_t,     /* context_handle */
 500  513          gss_const_buffer_t,     /* input_message_buffer */
 501  514          gss_buffer_t,           /* output_message_buffer */
 502  515          int *,                  /* conf_state */
 503  516          gss_qop_t *             /* qop_state */
 504  517  );
 505  518  
 506  519  GSS_DLLIMP OM_uint32 gss_display_status(
 507  520          OM_uint32 *,            /* minor_status */
 508  521          OM_uint32,              /* status_value */
 509  522          int,                    /* status_type */
 510  523          gss_const_OID,          /* mech_type (used to be const) */
 511  524          OM_uint32 *,            /* message_context */
 512  525          gss_buffer_t            /* status_string */
 513  526  );
 514  527  
 515  528  GSS_DLLIMP OM_uint32 gss_indicate_mechs(
 516  529          OM_uint32 *,            /* minor_status */
 517  530          gss_OID_set *           /* mech_set */
 518  531  );
 519  532  
 520  533  GSS_DLLIMP OM_uint32 gss_compare_name(
 521  534          OM_uint32 *,            /* minor_status */
 522  535          gss_const_name_t,       /* name1 */
 523  536          gss_const_name_t,       /* name2 */
 524  537          int *                   /* name_equal */
 525  538  );
 526  539  
 527  540  GSS_DLLIMP OM_uint32 gss_display_name(
 528  541          OM_uint32 *,            /* minor_status */
 529  542          gss_const_name_t,       /* input_name */
 530  543          gss_buffer_t,           /* output_name_buffer */
 531  544          gss_OID *               /* output_name_type */
 532  545  );
 533  546  
 534  547  GSS_DLLIMP OM_uint32 gss_import_name(
 535  548          OM_uint32 *,            /* minor_status */
 536  549          gss_const_buffer_t,     /* input_name_buffer */
 537  550          gss_const_OID,          /* input_name_type(used to be const) */
 538  551          gss_name_t *            /* output_name */
 539  552  );
 540  553  
 541  554  GSS_DLLIMP OM_uint32 gss_release_name(
 542  555          OM_uint32 *,            /* minor_status */
 543  556          gss_name_t *            /* input_name */
 544  557  );
 545  558  
 546  559  GSS_DLLIMP OM_uint32 gss_release_buffer(
 547  560          OM_uint32 *,            /* minor_status */
 548  561          gss_buffer_t            /* buffer */
 549  562  );
 550  563  
 551  564  GSS_DLLIMP OM_uint32 gss_release_oid_set(
 552  565          OM_uint32 *,            /* minor_status */
 553  566          gss_OID_set *           /* set */
 554  567  );
 555  568  
 556  569  GSS_DLLIMP OM_uint32 gss_inquire_cred(
 557  570          OM_uint32 *,            /* minor_status */
 558  571          gss_const_cred_id_t,    /* cred_handle */
 559  572          gss_name_t *,           /* name */
 560  573          OM_uint32 *,            /* lifetime */
 561  574          gss_cred_usage_t *,     /* cred_usage */
 562  575          gss_OID_set *           /* mechanisms */
 563  576  );
 564  577  
 565  578  /* Last argument new for V2 */
 566  579  GSS_DLLIMP OM_uint32 gss_inquire_context(
 567  580          OM_uint32 *,            /* minor_status */
 568  581          gss_const_ctx_id_t,     /* context_handle */
 569  582          gss_name_t *,           /* src_name */
 570  583          gss_name_t *,           /* targ_name */
 571  584          OM_uint32 *,            /* lifetime_rec */
 572  585          gss_OID *,              /* mech_type */
 573  586          OM_uint32 *,            /* ctx_flags */
 574  587          int *,                  /* locally_initiated */
 575  588          int *                   /* open */
 576  589  );
 577  590  
 578  591  /* New for V2 */
 579  592  GSS_DLLIMP OM_uint32 gss_wrap_size_limit(
 580  593          OM_uint32 *,            /* minor_status */
 581  594          gss_const_ctx_id_t,     /* context_handle */
 582  595          int,                    /* conf_req_flag */
 583  596          gss_qop_t,              /* qop_req */
 584  597          OM_uint32,              /* req_output_size */
 585  598          OM_uint32 *             /* max_input_size */
 586  599  );
 587  600  
 588  601  /* New for V2 */
 589  602  GSS_DLLIMP OM_uint32 gss_add_cred(
 590  603          OM_uint32 *,            /* minor_status */
 591  604          gss_const_cred_id_t,    /* input_cred_handle */
 592  605          gss_const_name_t,       /* desired_name */
 593  606          gss_const_OID,          /* desired_mech */
 594  607          gss_cred_usage_t,       /* cred_usage */
 595  608          OM_uint32,              /* initiator_time_req */
 596  609          OM_uint32,              /* acceptor_time_req */
 597  610          gss_cred_id_t *,        /* output_cred_handle */
 598  611          gss_OID_set *,          /* actual_mechs */
 599  612          OM_uint32 *,            /* initiator_time_rec */
 600  613          OM_uint32 *             /* acceptor_time_rec */
 601  614  );
 602  615  
 603  616  /* New for V2 */
 604  617  GSS_DLLIMP OM_uint32 gss_inquire_cred_by_mech(
 605  618          OM_uint32 *,            /* minor_status */
 606  619          gss_const_cred_id_t,    /* cred_handle */
 607  620          gss_const_OID,          /* mech_type */
 608  621          gss_name_t *,           /* name */
 609  622          OM_uint32 *,            /* initiator_lifetime */
 610  623          OM_uint32 *,            /* acceptor_lifetime */
 611  624          gss_cred_usage_t *      /* cred_usage */
 612  625  );
 613  626  
 614  627  /* New for V2 */
 615  628  GSS_DLLIMP OM_uint32 gss_export_sec_context(
 616  629          OM_uint32 *,            /* minor_status */
 617  630          gss_ctx_id_t *,         /* context_handle */
 618  631          gss_buffer_t            /* interprocess_token */
 619  632  );
 620  633  
 621  634  /* New for V2 */
 622  635  GSS_DLLIMP OM_uint32 gss_import_sec_context(
 623  636          OM_uint32 *,            /* minor_status */
 624  637          gss_const_buffer_t,     /* interprocess_token */
 625  638          gss_ctx_id_t *          /* context_handle */
 626  639  );
 627  640  
 628  641  /* New for V2 */
 629  642  GSS_DLLIMP OM_uint32 gss_release_oid(
 630  643          OM_uint32 *,            /* minor_status */
 631  644          gss_OID *               /* oid */
 632  645  );
 633  646  
 634  647  /* New for V2 */
 635  648  GSS_DLLIMP OM_uint32 gss_create_empty_oid_set(
 636  649          OM_uint32 *,            /* minor_status */
 637  650          gss_OID_set *           /* oid_set */
 638  651  );
 639  652  
 640  653  /* New for V2 */
 641  654  GSS_DLLIMP OM_uint32 gss_add_oid_set_member(
 642  655          OM_uint32 *,            /* minor_status */
 643  656          gss_const_OID,          /* member_oid */
 644  657          gss_OID_set *           /* oid_set */
 645  658  );
 646  659  
 647  660  /* New for V2 */
 648  661  GSS_DLLIMP OM_uint32 gss_test_oid_set_member(
 649  662          OM_uint32 *,            /* minor_status */
 650  663          gss_const_OID,          /* member */
 651  664          gss_const_OID_set,      /* set */
 652  665          int *                   /* present */
 653  666  );
 654  667  
 655  668  /* New for V2 */
 656  669  GSS_DLLIMP OM_uint32 gss_str_to_oid(
 657  670          OM_uint32 *,            /* minor_status */
 658  671          gss_const_buffer_t,     /* oid_str */
 659  672          gss_OID *               /* oid */
 660  673  );
 661  674  
 662  675  /* New for V2 */
 663  676  GSS_DLLIMP OM_uint32 gss_oid_to_str(
 664  677          OM_uint32 *,            /* minor_status */
 665  678          gss_OID,                /* oid */
 666  679          gss_buffer_t            /* oid_str */
 667  680  );
 668  681  
 669  682  /* New for V2 */
 670  683  GSS_DLLIMP OM_uint32 gss_inquire_names_for_mech(
 671  684          OM_uint32 *,            /* minor_status */
 672  685          gss_const_OID,          /* mechanism */
 673  686          gss_OID_set *           /* name_types */
 674  687  );
 675  688  
 676  689  /* New for V2 */
 677  690  GSS_DLLIMP OM_uint32 gss_export_name(
 678  691          OM_uint32  *,           /* minor_status */
 679  692          gss_const_name_t,       /* input_name */
 680  693          gss_buffer_t            /* exported_name */
 681  694  );
 682  695  
 683  696  /* New for V2 */
 684  697  GSS_DLLIMP OM_uint32 gss_duplicate_name(
 685  698          OM_uint32  *,           /* minor_status */
 686  699          gss_const_name_t,       /* input_name */
 687  700          gss_name_t *            /* dest_name */
 688  701  );
 689  702  
 690  703  /* New for V2 */
</pre>
<table id='hb-elided2' class='hidebar'>
  <tr>
    <td class='active-down'
      onclick='show_n_hide_dir("elided2", "hb-elided2", "down")'>
      &darr;&nbsp;open down&nbsp;&darr;</td>
    <td class="elided-label">559 lines elided</td>
    <td class='active-up'
      onclick='show_n_hide_dir("elided2", "hb-elided2", "up")'>
      &uarr;&nbsp;open up&nbsp;&uarr;</td>
  </tr>
</table>
<pre> 691  704  GSS_DLLIMP OM_uint32 gss_canonicalize_name(
 692  705          OM_uint32  *,           /* minor_status */
 693  706          gss_const_name_t,       /* input_name */
 694  707          gss_const_OID,          /* mech_type */
 695  708          gss_name_t *            /* output_name */
 696  709  );
 697  710  
 698  711  #if TARGET_OS_MAC
 699  712  #    pragma pack(pop)
 700  713  #endif
<span class='added'>      714 +
      715 +/* Common extension (NOT in RFC2744) */
      716 +OM_uint32
      717 +gss_add_cred_with_password(
      718 +        OM_uint32 *,            /* minor_status */
      719 +        gss_const_cred_id_t,    /* input_cred_handle */
      720 +        gss_const_name_t,       /* desired_name */
      721 +        gss_const_OID,          /* desired_mech */
      722 +        gss_const_buffer_t,     /* password */
      723 +        gss_cred_usage_t,       /* cred_usage */
      724 +        OM_uint32,              /* initiator_time_req */
      725 +        OM_uint32,              /* acceptor_time_req */
      726 +        gss_cred_id_t *,        /* output_cred_handle */
      727 +        gss_OID_set *,          /* actual_mechs */
      728 +        OM_uint32 *,            /* initiator_time_rec */
      729 +        OM_uint32 *             /* acceptor_time_rec */
      730 +);
      731 +
      732 +/* Common extension for aname2lname (NOT in RFC2744) */
      733 +OM_uint32
      734 +gss_localname(
      735 +        OM_uint32 *,            /* minor_status */
      736 +        gss_const_name_t,       /* name */
      737 +        gss_OID,                /* mech_type */
      738 +        gss_buffer_t            /* localname */
      739 +);
</span> 701  740  
 702  741  #ifdef __cplusplus
 703  742  }
 704  743  #endif
 705  744  
 706  745  #endif /* _GSSAPI_H_ */
    </pre>
<pre id='linerefpre'><span id='lineref'>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span></pre>
    <br clear="all" />
    <br />

    <script type="text/javascript">
      /* Assign event handlers and widths. */
      var w = document.getElementById('lineref').offsetWidth;
      for (var i = 1; i <= 2; ++i) {
	      var e = document.getElementById("elided" + i);
	      e.onclick = handle_click;
              e.style.setProperty('width', w + "px", '');

	      e = document.getElementById("hb-elided" + i);
              e.style.setProperty('width', w + "px", '');
      }

      /* Hide our line size reference. */
      document.getElementById('linerefpre').style.setProperty('display',
          'none', '');

      /* Scroll as indicated. */
      str = location.search;
      s = str.substring(1, str.length);
      if (s > 0)
        window.scroll(0, s);

      function open_or_close_all(open) {
	      for (var i = 1; i <= 2; ++i) {
		      var e = document.getElementById("hb-elided" + i);
		      e.style.setProperty("display", open ? "none" : "", "");

		      e = document.getElementById("elided" + i);
		      e.style.setProperty("display", open ? "" : "none", "");
	      }
      }
    </script>
  </body>
</html>
