<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="cache-control" content="no-cache"></meta>
<meta http-equiv="Content-Type" content="text/xhtml;charset=utf-8"></meta>
<meta http-equiv="Pragma" content="no-cache"></meta>
<meta http-equiv="Expires" content="-1"></meta>
<!--
   Note to customizers: the body of the webrev is IDed as SUNWwebrev
   to allow easy overriding by users of webrev via the userContent.css
   mechanism available in some browsers.

   For example, to have all "removed" information be red instead of
   brown, set a rule in your userContent.css file like:

       body#SUNWwebrev span.removed { color: red ! important; }
-->
<style type="text/css" media="screen">
body {
    background-color: #eeeeee;
}
hr {
    border: none 0;
    border-top: 1px solid #aaa;
    height: 1px;
}
div.summary {
    font-size: .8em;
    border-bottom: 1px solid #aaa;
    padding-left: 1em;
    padding-right: 1em;
}
div.summary h2 {
    margin-bottom: 0.3em;
}
div.summary table th {
    text-align: right;
    vertical-align: top;
    white-space: nowrap;
}
span.lineschanged {
    font-size: 0.7em;
}
span.oldmarker {
    color: red;
    font-size: large;
    font-weight: bold;
}
span.newmarker {
    color: green;
    font-size: large;
    font-weight: bold;
}
span.removed {
    color: brown;
}
span.changed {
    color: blue;
}
span.new {
    color: blue;
    font-weight: bold;
}
span.chmod {
    font-size: 0.7em;
    color: #db7800;
}
a.print { font-size: x-small; }
a:hover { background-color: #ffcc99; }
</style>

<style type="text/css" media="print">
pre { font-size: 0.8em; font-family: courier, monospace; }
span.removed { color: #444; font-style: italic }
span.changed { font-weight: bold; }
span.new { font-weight: bold; }
span.newmarker { font-size: 1.2em; font-weight: bold; }
span.oldmarker { font-size: 1.2em; font-weight: bold; }
a.print {display: none}
hr { border: none 0; border-top: 1px solid #aaa; height: 1px; }
</style>

<title>ws Sdiff src/java.security.jgss/share/native/libj2gss/NativeFunc.c</title>
</head><body id="SUNWwebrev">
<a class="print" href="javascript:print()">Print this page</a>
<pre>Add JGSS JNI bindings for gss cred store functions
Add createCredential() with password
Also avoid memory allocation in newGSSOIDSet() renamed to makeGSSOIDset()
which now takes a singleton set argument and either assigns the requested
OID or with SPNEGO returns a static list of all the supported mechs. With
this we no longer need deleteGSSOIDSet().
Add getLocalName() GSSName method</pre>

<table><tr valign="top">
<td><pre>

</pre><hr></hr><pre>
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
  23  * questions.
  24  */
  25 
  26 #include &lt;stdio.h&gt;
  27 #include &lt;stdlib.h&gt;
  28 #include "NativeFunc.h"
  29 
  30 /* standard GSS method names (ordering is from mapfile) */
  31 static const char RELEASE_NAME[]                = "gss_release_name";
  32 static const char IMPORT_NAME[]                 = "gss_import_name";
  33 static const char COMPARE_NAME[]                = "gss_compare_name";
  34 static const char CANONICALIZE_NAME[]           = "gss_canonicalize_name";
  35 static const char EXPORT_NAME[]                 = "gss_export_name";
  36 static const char DISPLAY_NAME[]                = "gss_display_name";

  37 static const char ACQUIRE_CRED[]                = "gss_acquire_cred";



  38 static const char RELEASE_CRED[]                = "gss_release_cred";
  39 static const char INQUIRE_CRED[]                = "gss_inquire_cred";
  40 static const char IMPORT_SEC_CONTEXT[]          = "gss_import_sec_context";
  41 static const char INIT_SEC_CONTEXT[]            = "gss_init_sec_context";
  42 static const char ACCEPT_SEC_CONTEXT[]          = "gss_accept_sec_context";
  43 static const char INQUIRE_CONTEXT[]             = "gss_inquire_context";
  44 static const char DELETE_SEC_CONTEXT[]          = "gss_delete_sec_context";
  45 static const char CONTEXT_TIME[]                = "gss_context_time";
  46 static const char WRAP_SIZE_LIMIT[]             = "gss_wrap_size_limit";
  47 static const char EXPORT_SEC_CONTEXT[]          = "gss_export_sec_context";
  48 static const char GET_MIC[]                     = "gss_get_mic";
  49 static const char VERIFY_MIC[]                  = "gss_verify_mic";
  50 static const char WRAP[]                        = "gss_wrap";
  51 static const char UNWRAP[]                      = "gss_unwrap";
  52 static const char INDICATE_MECHS[]              = "gss_indicate_mechs";
  53 static const char INQUIRE_NAMES_FOR_MECH[]      = "gss_inquire_names_for_mech";
  54 
  55 /* additional GSS methods not public thru mapfile */
  56 
  57 static const char ADD_OID_SET_MEMBER[]          = "gss_add_oid_set_member";

</pre><hr></hr><pre>
 105 
 106     ftab-&gt;canonicalizeName = (CANONICALIZE_NAME_FN_PTR)
 107                                 GETFUNC(gssLib, CANONICALIZE_NAME);
 108     if (ftab-&gt;canonicalizeName == NULL) {
 109         failed = TRUE;
 110         goto out;
 111     }
 112 
 113     ftab-&gt;exportName = (EXPORT_NAME_FN_PTR)GETFUNC(gssLib, EXPORT_NAME);
 114     if (ftab-&gt;exportName == NULL) {
 115         failed = TRUE;
 116         goto out;
 117     }
 118 
 119     ftab-&gt;displayName = (DISPLAY_NAME_FN_PTR)GETFUNC(gssLib, DISPLAY_NAME);
 120     if (ftab-&gt;displayName == NULL) {
 121         failed = TRUE;
 122         goto out;
 123     }
 124 






 125     ftab-&gt;acquireCred = (ACQUIRE_CRED_FN_PTR)GETFUNC(gssLib, ACQUIRE_CRED);
 126     if (ftab-&gt;acquireCred == NULL) {
 127         failed = TRUE;
 128         goto out;
 129     }











 130 
 131     ftab-&gt;releaseCred = (RELEASE_CRED_FN_PTR)GETFUNC(gssLib, RELEASE_CRED);
 132     if (ftab-&gt;releaseCred == NULL) {
 133         failed = TRUE;
 134         goto out;
 135     }
 136 
 137     ftab-&gt;inquireCred = (INQUIRE_CRED_FN_PTR)GETFUNC(gssLib, INQUIRE_CRED);
 138     if (ftab-&gt;inquireCred == NULL) {
 139         failed = TRUE;
 140         goto out;
 141     }
 142 
 143     ftab-&gt;importSecContext = (IMPORT_SEC_CONTEXT_FN_PTR)
 144                         GETFUNC(gssLib, IMPORT_SEC_CONTEXT);
 145     if (ftab-&gt;importSecContext == NULL) {
 146         failed = TRUE;
 147         goto out;
 148     }
 149 

</pre><hr></hr>
</pre></td><td><pre>

</pre><hr></hr><pre>
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
  23  * questions.
  24  */
  25 
  26 #include &lt;stdio.h&gt;
  27 #include &lt;stdlib.h&gt;
  28 #include "NativeFunc.h"
  29 
  30 /* standard GSS method names (ordering is from mapfile) */
  31 static const char RELEASE_NAME[]                = "gss_release_name";
  32 static const char IMPORT_NAME[]                 = "gss_import_name";
  33 static const char COMPARE_NAME[]                = "gss_compare_name";
  34 static const char CANONICALIZE_NAME[]           = "gss_canonicalize_name";
  35 static const char EXPORT_NAME[]                 = "gss_export_name";
  36 static const char DISPLAY_NAME[]                = "gss_display_name";
<span class="new">  37 static const char LOCAL_NAME[]                  = "gss_localname";</span>
  38 static const char ACQUIRE_CRED[]                = "gss_acquire_cred";
<span class="new">  39 static const char ACQUIRE_CRED_WITH_PASSWORD[]  = "gss_acquire_cred_with_password";</span>
<span class="new">  40 static const char ACQUIRE_CRED_FROM[]           = "gss_acquire_cred_from";</span>
<span class="new">  41 static const char STORE_CRED_INTO[]             = "gss_store_cred_into";</span>
  42 static const char RELEASE_CRED[]                = "gss_release_cred";
  43 static const char INQUIRE_CRED[]                = "gss_inquire_cred";
  44 static const char IMPORT_SEC_CONTEXT[]          = "gss_import_sec_context";
  45 static const char INIT_SEC_CONTEXT[]            = "gss_init_sec_context";
  46 static const char ACCEPT_SEC_CONTEXT[]          = "gss_accept_sec_context";
  47 static const char INQUIRE_CONTEXT[]             = "gss_inquire_context";
  48 static const char DELETE_SEC_CONTEXT[]          = "gss_delete_sec_context";
  49 static const char CONTEXT_TIME[]                = "gss_context_time";
  50 static const char WRAP_SIZE_LIMIT[]             = "gss_wrap_size_limit";
  51 static const char EXPORT_SEC_CONTEXT[]          = "gss_export_sec_context";
  52 static const char GET_MIC[]                     = "gss_get_mic";
  53 static const char VERIFY_MIC[]                  = "gss_verify_mic";
  54 static const char WRAP[]                        = "gss_wrap";
  55 static const char UNWRAP[]                      = "gss_unwrap";
  56 static const char INDICATE_MECHS[]              = "gss_indicate_mechs";
  57 static const char INQUIRE_NAMES_FOR_MECH[]      = "gss_inquire_names_for_mech";
  58 
  59 /* additional GSS methods not public thru mapfile */
  60 
  61 static const char ADD_OID_SET_MEMBER[]          = "gss_add_oid_set_member";

</pre><hr></hr><pre>
 109 
 110     ftab-&gt;canonicalizeName = (CANONICALIZE_NAME_FN_PTR)
 111                                 GETFUNC(gssLib, CANONICALIZE_NAME);
 112     if (ftab-&gt;canonicalizeName == NULL) {
 113         failed = TRUE;
 114         goto out;
 115     }
 116 
 117     ftab-&gt;exportName = (EXPORT_NAME_FN_PTR)GETFUNC(gssLib, EXPORT_NAME);
 118     if (ftab-&gt;exportName == NULL) {
 119         failed = TRUE;
 120         goto out;
 121     }
 122 
 123     ftab-&gt;displayName = (DISPLAY_NAME_FN_PTR)GETFUNC(gssLib, DISPLAY_NAME);
 124     if (ftab-&gt;displayName == NULL) {
 125         failed = TRUE;
 126         goto out;
 127     }
 128 
<span class="new"> 129     /*</span>
<span class="new"> 130      * This one may not be available for a given GSS library, as it's an</span>
<span class="new"> 131      * extension, therefore we don't fail if it's missing.</span>
<span class="new"> 132      */</span>
<span class="new"> 133     ftab-&gt;localName = (LOCAL_NAME_FN_PTR)GETFUNC(gssLib, LOCAL_NAME);</span>
<span class="new"> 134 </span>
 135     ftab-&gt;acquireCred = (ACQUIRE_CRED_FN_PTR)GETFUNC(gssLib, ACQUIRE_CRED);
 136     if (ftab-&gt;acquireCred == NULL) {
 137         failed = TRUE;
 138         goto out;
 139     }
<span class="new"> 140 </span>
<span class="new"> 141     /*</span>
<span class="new"> 142      * These may not be available for a given GSS library, as they are</span>
<span class="new"> 143      * extensions, therefore we don't fail if it's missing.</span>
<span class="new"> 144      */</span>
<span class="new"> 145     ftab-&gt;acquireCredWithPassword = (ACQUIRE_CRED_WITH_PASSWORD_FN_PTR)</span>
<span class="new"> 146                         GETFUNC(gssLib, ACQUIRE_CRED_WITH_PASSWORD);</span>
<span class="new"> 147     ftab-&gt;acquireCredFrom = (ACQUIRE_CRED_FROM_FN_PTR)</span>
<span class="new"> 148                         GETFUNC(gssLib, ACQUIRE_CRED_FROM);</span>
<span class="new"> 149     ftab-&gt;storeCredInto = (STORE_CRED_INTO_FN_PTR)</span>
<span class="new"> 150                         GETFUNC(gssLib, STORE_CRED_INTO);</span>
 151 
 152     ftab-&gt;releaseCred = (RELEASE_CRED_FN_PTR)GETFUNC(gssLib, RELEASE_CRED);
 153     if (ftab-&gt;releaseCred == NULL) {
 154         failed = TRUE;
 155         goto out;
 156     }
 157 
 158     ftab-&gt;inquireCred = (INQUIRE_CRED_FN_PTR)GETFUNC(gssLib, INQUIRE_CRED);
 159     if (ftab-&gt;inquireCred == NULL) {
 160         failed = TRUE;
 161         goto out;
 162     }
 163 
 164     ftab-&gt;importSecContext = (IMPORT_SEC_CONTEXT_FN_PTR)
 165                         GETFUNC(gssLib, IMPORT_SEC_CONTEXT);
 166     if (ftab-&gt;importSecContext == NULL) {
 167         failed = TRUE;
 168         goto out;
 169     }
 170 

</pre><hr></hr>
</pre></td>
</tr></table>
</body></html>
