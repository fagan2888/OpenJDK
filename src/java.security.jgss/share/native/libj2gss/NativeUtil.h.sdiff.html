<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="cache-control" content="no-cache"></meta>
<meta http-equiv="Content-Type" content="text/xhtml;charset=utf-8"></meta>
<meta http-equiv="Pragma" content="no-cache"></meta>
<meta http-equiv="Expires" content="-1"></meta>
<!--
   Note to customizers: the body of the webrev is IDed as SUNWwebrev
   to allow easy overriding by users of webrev via the userContent.css
   mechanism available in some browsers.

   For example, to have all "removed" information be red instead of
   brown, set a rule in your userContent.css file like:

       body#SUNWwebrev span.removed { color: red ! important; }
-->
<style type="text/css" media="screen">
body {
    background-color: #eeeeee;
}
hr {
    border: none 0;
    border-top: 1px solid #aaa;
    height: 1px;
}
div.summary {
    font-size: .8em;
    border-bottom: 1px solid #aaa;
    padding-left: 1em;
    padding-right: 1em;
}
div.summary h2 {
    margin-bottom: 0.3em;
}
div.summary table th {
    text-align: right;
    vertical-align: top;
    white-space: nowrap;
}
span.lineschanged {
    font-size: 0.7em;
}
span.oldmarker {
    color: red;
    font-size: large;
    font-weight: bold;
}
span.newmarker {
    color: green;
    font-size: large;
    font-weight: bold;
}
span.removed {
    color: brown;
}
span.changed {
    color: blue;
}
span.new {
    color: blue;
    font-weight: bold;
}
span.chmod {
    font-size: 0.7em;
    color: #db7800;
}
a.print { font-size: x-small; }
a:hover { background-color: #ffcc99; }
</style>

<style type="text/css" media="print">
pre { font-size: 0.8em; font-family: courier, monospace; }
span.removed { color: #444; font-style: italic }
span.changed { font-weight: bold; }
span.new { font-weight: bold; }
span.newmarker { font-size: 1.2em; font-weight: bold; }
span.oldmarker { font-size: 1.2em; font-weight: bold; }
a.print {display: none}
hr { border: none 0; border-top: 1px solid #aaa; height: 1px; }
</style>

<title>ws Sdiff src/java.security.jgss/share/native/libj2gss/NativeUtil.h</title>
</head><body id="SUNWwebrev">
<a class="print" href="javascript:print()">Print this page</a>
<pre>Add JGSS JNI bindings for gss cred store functions
Add createCredential() with password
Also avoid memory allocation in newGSSOIDSet() renamed to makeGSSOIDset()
which now takes a singleton set argument and either assigns the requested
OID or with SPNEGO returns a static list of all the supported mechs. With
this we no longer need deleteGSSOIDSet().
Revert initGSSBuffer to JDK7 non-copy behaviour
Implement String to gss_buffer_t import
Fix error handling in GSSLibStub
Also improve object size handling in NativeUtil.</pre>

<table><tr valign="top">
<td><pre>

</pre><hr></hr><pre>
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
  23  * questions.
  24  */
  25 
  26 #include &lt;jni.h&gt;
  27 #include &lt;stdlib.h&gt;
  28 #include &lt;string.h&gt;
  29 #include &lt;inttypes.h&gt;
  30 #include "gssapi.h"
  31 
  32 #ifndef _Included_NATIVE_Util
  33 #define _Included_NATIVE_Util
  34 #ifdef __cplusplus
  35 extern "C" {
  36 #endif
  37   extern jint getJavaTime(OM_uint32);
  38   extern OM_uint32 getGSSTime(jint);
<span class="changed">  39   extern void checkStatus(JNIEnv *, jobject, OM_uint32, OM_uint32, char*);</span>
  40   extern jint checkTime(OM_uint32);
  41   extern void throwOutOfMemoryError(JNIEnv *, const char*);
<span class="changed">  42   extern void initGSSBuffer(JNIEnv *, jbyteArray, gss_buffer_t);</span>
<span class="changed">  43   extern void resetGSSBuffer(gss_buffer_t);</span>




  44 
  45   extern gss_OID newGSSOID(JNIEnv *, jobject);
  46   extern void deleteGSSOID(gss_OID);
<span class="changed">  47   extern gss_OID_set newGSSOIDSet(gss_OID);</span>
<span class="changed">  48   extern void deleteGSSOIDSet(gss_OID_set);</span>
  49 
<span class="changed">  50   extern jbyteArray getJavaBuffer(JNIEnv *, gss_buffer_t);</span>
  51   extern jstring getJavaString(JNIEnv *, gss_buffer_t);
  52   extern jobject getJavaOID(JNIEnv *, gss_OID);
  53   extern jobjectArray getJavaOIDArray(JNIEnv *, gss_OID_set);
  54 
  55   extern jstring getMinorMessage(JNIEnv *, jobject, OM_uint32);
  56   extern int sameMech(gss_OID, gss_OID);
  57 
  58   extern int JGSS_DEBUG;
  59 
  60   extern jclass CLS_Object;
  61   extern jclass CLS_GSSNameElement;
  62   extern jclass CLS_GSSCredElement;
  63   extern jclass CLS_NativeGSSContext;
  64   extern jmethodID MID_MessageProp_getPrivacy;
  65   extern jmethodID MID_MessageProp_getQOP;
  66   extern jmethodID MID_MessageProp_setPrivacy;
  67   extern jmethodID MID_MessageProp_setQOP;
  68   extern jmethodID MID_MessageProp_setSupplementaryStates;
  69   extern jmethodID MID_ChannelBinding_getInitiatorAddr;
  70   extern jmethodID MID_ChannelBinding_getAcceptorAddr;

</pre><hr></hr>
</pre></td><td><pre>

</pre><hr></hr><pre>
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
  23  * questions.
  24  */
  25 
  26 #include &lt;jni.h&gt;
  27 #include &lt;stdlib.h&gt;
  28 #include &lt;string.h&gt;
  29 #include &lt;inttypes.h&gt;
  30 #include "gssapi.h"
  31 
  32 #ifndef _Included_NATIVE_Util
  33 #define _Included_NATIVE_Util
  34 #ifdef __cplusplus
  35 extern "C" {
  36 #endif
  37   extern jint getJavaTime(OM_uint32);
  38   extern OM_uint32 getGSSTime(jint);
<span class="changed">  39   extern void checkStatus(JNIEnv *, jobject, OM_uint32, OM_uint32, const char *);</span>
  40   extern jint checkTime(OM_uint32);
  41   extern void throwOutOfMemoryError(JNIEnv *, const char*);
<span class="changed">  42   extern void initGSSBuffer(JNIEnv *, jbyteArray, gss_buffer_t, jboolean);</span>
<span class="changed">  43   extern void resetGSSBuffer(JNIEnv *, jbyteArray, gss_buffer_t);</span>
<span class="changed">  44   extern void initGSSBufferString(JNIEnv *, jstring, gss_buffer_t);</span>
<span class="changed">  45   extern void resetGSSBufferString(JNIEnv *, jstring, gss_buffer_t);</span>
<span class="changed">  46   extern void initGSSCredStore(JNIEnv *, jarray, gss_key_value_set_desc *);</span>
<span class="changed">  47   extern void resetGSSCredStore(JNIEnv *, jarray, gss_key_value_set_desc *);</span>
  48 
  49   extern gss_OID newGSSOID(JNIEnv *, jobject);
  50   extern void deleteGSSOID(gss_OID);
<span class="changed">  51   extern gss_OID_set makeGSSOIDSet(gss_OID_set, gss_OID);</span>

  52 
<span class="changed">  53   extern jbyteArray getJavaBuffer(JNIEnv *, gss_buffer_t, jboolean);</span>
  54   extern jstring getJavaString(JNIEnv *, gss_buffer_t);
  55   extern jobject getJavaOID(JNIEnv *, gss_OID);
  56   extern jobjectArray getJavaOIDArray(JNIEnv *, gss_OID_set);
  57 
  58   extern jstring getMinorMessage(JNIEnv *, jobject, OM_uint32);
  59   extern int sameMech(gss_OID, gss_OID);
  60 
  61   extern int JGSS_DEBUG;
  62 
  63   extern jclass CLS_Object;
  64   extern jclass CLS_GSSNameElement;
  65   extern jclass CLS_GSSCredElement;
  66   extern jclass CLS_NativeGSSContext;
  67   extern jmethodID MID_MessageProp_getPrivacy;
  68   extern jmethodID MID_MessageProp_getQOP;
  69   extern jmethodID MID_MessageProp_setPrivacy;
  70   extern jmethodID MID_MessageProp_setQOP;
  71   extern jmethodID MID_MessageProp_setSupplementaryStates;
  72   extern jmethodID MID_ChannelBinding_getInitiatorAddr;
  73   extern jmethodID MID_ChannelBinding_getAcceptorAddr;

</pre><hr></hr>
</pre></td>
</tr></table>
</body></html>
